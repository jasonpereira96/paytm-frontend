(this["webpackJsonppaytm-frontend"]=this["webpackJsonppaytm-frontend"]||[]).push([[0],{103:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(10),o=t.n(c),i=t(17),l=t(18),u=t(61),s=(t(82),t(83),t(21)),m=t(22),d=t(24),p=t(23),f=t(131),E=t(133),v=t(134),g=t(38),h=Object(f.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function b(){var e=h();return r.a.createElement("div",{className:e.root},r.a.createElement(E.a,{position:"static"},r.a.createElement(v.a,null,r.a.createElement(g.a,{variant:"h6",className:e.title},"Image Upload Assignment"))))}var O=t(14),C=t.n(O),y=t(25),k=t(20),j=t(136),_=t(135),w=t(65),S=t.n(w),I=t(137),A="https://paytm-app-jason.herokuapp.com";function R(e){return new Promise((function(n,t){0===e.files.length&&n({ok:!1,reason:"No file selected"});var a=e.files[0];Math.round(a.size/1024)>2e3&&n({ok:!1,reason:"File too big"}),n({ok:!0})})).then((function(n){return n.ok?function(e){var n=e.files[0];return new Promise((function(e,t){var a=new FileReader;a.addEventListener("load",(function(){var n=new Image;n.src=a.result,n.onload=function(){1024===n.height&&1024===n.width?e({ok:!0}):e({ok:!1,reason:"Incorrect dimensions. Should be ".concat(1024," x ").concat(1024)})}}),!1),a.readAsDataURL(n)}))}(e):n}))}var L=function(e){return{type:"IMAGES_ADDED",images:e}},N=function(e){return{type:"ERROR_OCCURED",error:e}},D=t(43),T=t.n(D);function F(e){return U.apply(this,arguments)}function U(){return(U=Object(y.a)(C.a.mark((function e(n){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("file",n),e.abrupt("return",T.a.post("".concat(A,"/upload"),t,{headers:{"Content-Type":"multipart/form-data"}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return x.apply(this,arguments)}function x(){return(x=Object(y.a)(C.a.mark((function e(n){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.a.get("".concat(A,"/image"),{params:{id:n}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){return function(n){n(function(e){return{type:"UPLOAD_FAILURE",error:e}}(e)),setTimeout((function(){n({type:"SNACKBAR_CLOSE"})}),2500)}}var P=t(141),G=t(142);function M(e){return r.a.createElement(G.a,Object.assign({elevation:6,variant:"filled"},e))}var V=Object(f.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function z(e){var n=V(),t=e.open,a=e.message;return r.a.createElement("div",{className:n.root},r.a.createElement(P.a,{open:t,autoHideDuration:2e3,onClose:function(e,n){}},r.a.createElement(M,{severity:"error"},a)))}var H=function(e){Object(d.a)(t,e);var n=Object(p.a)(t);function t(e){var a;return Object(s.a)(this,t),(a=n.call(this,e)).onUploadButtonClick=a.onUploadButtonClick.bind(Object(k.a)(a)),a.onFileChange=a.onFileChange.bind(Object(k.a)(a)),a}return Object(m.a)(t,[{key:"render",value:function(){var e=this.props.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"upload-panel-section"},r.a.createElement(_.a,{variant:"extended",color:"primary","aria-label":"add",component:"label"},r.a.createElement(S.a,null),"Choose File",r.a.createElement("input",{type:"file",style:{display:"none"},id:"file-input",onChange:this.onFileChange,accept:"image/*"})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(g.a,{variant:"h5",component:"h5"},this.props.fileName)),r.a.createElement("div",{className:"upload-panel-section",id:"upload-button-section"},r.a.createElement(j.a,{variant:"contained",color:"primary",onClick:this.onUploadButtonClick},"Upload")),r.a.createElement("div",{className:"upload-panel-section",id:"loading-section"},this.props.uploading?r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,null),r.a.createElement("br",null),"Loading..."):r.a.createElement("br",null)),r.a.createElement(z,{open:null!==e,message:e}))}},{key:"onUploadButtonClick",value:function(){var e=Object(y.a)(C.a.mark((function e(){var n,t,a,r,c,o,i,l,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("file-input"),t=this.props,a=t.errorOccured,r=t.snackbarClose,c=t.uploadFile,e.next=4,R(n);case 4:o=e.sent,i=o.ok,l=o.reason,u=n.files[0],i?c(u):(console.log(l),a(l),setTimeout((function(){return r()}),2500));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onFileChange",value:function(){var e=document.getElementById("file-input"),n=this.props.fileChanged;0===e.files.length?n(null):n(e.files[0])}}]),t}(r.a.Component),q=Object(i.b)((function(e){var n=e.uploadScreen.uploadPanel,t=n.file,a=n.error,r=n.uploading;return{fileName:t?t.name:null,error:a,uploading:r}}),(function(e){return{fileChanged:function(n){return e(function(e){return{type:"FILE_CHANGED",file:e}}(n))},errorOccured:function(n){return e(N(n))},snackbarClose:function(){return e({type:"SNACKBAR_CLOSE"})},uploadFile:function(n){return e(function(e){return function(){var n=Object(y.a)(C.a.mark((function n(t){var a,r;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t({type:"START_UPLOAD"}),n.prev=1,n.next=4,F(e);case 4:a=n.sent,r=a.data,console.log(r),r.error?t(K(r.error)):(t({type:"UPLOAD_SUCCESS",id:void 0,name:void 0}),t(L([{id:r.id,name:r.name}]))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),t(K(n.t0));case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e){return n.apply(this,arguments)}}()}(n))}}}))(H),J=t(138),W=t(143),X=t(139),Q=t(140),$=t(66),Y=t.n($),Z=function(e){Object(d.a)(t,e);var n=Object(p.a)(t);function t(e){var a;return Object(s.a)(this,t),(a=n.call(this,e)).onImageTitleClick=a.onImageTitleClick.bind(Object(k.a)(a)),a}return Object(m.a)(t,[{key:"render",value:function(){var e=this.onImageTitleClick,n=this.props.images;return 0===n.length?r.a.createElement("div",{id:"cp-div"},r.a.createElement(I.a,null)):r.a.createElement("div",null,r.a.createElement(J.a,{component:"nav","aria-label":"main mailbox folders"},n.map((function(n){return r.a.createElement(W.a,{button:!0,key:n.id,onClick:function(){return e(n.id)}},r.a.createElement(X.a,null,r.a.createElement(Y.a,null)),r.a.createElement(Q.a,{primary:"".concat(n.name?n.name:"Image-"+n.id)}))}))))}},{key:"componentDidMount",value:function(){var e=this,n=this.props,t=n.images,a=n.errorOccured,r=n.snackbarClose;0===t.length&&fetch("".concat(A,"/images")).then((function(e){return e.json()})).then((function(n){e.props.imagesAdded(n.images)})).catch((function(e){console.log(e),a("Failed to fetch images"),setTimeout((function(){return r()}),2500)}))}},{key:"onImageTitleClick",value:function(e){console.log("image id: ".concat(e)),this.props.imageTitleClick(e)}}]),t}(r.a.Component),ee=Object(i.b)((function(e){return{images:e.uploadScreen.listPanel.images,loading:e.uploadScreen.listPanel.loading}}),(function(e){return{imagesAdded:function(n){return e(L(n))},imageTitleClick:function(n){return e(function(e){return{type:"IMAGE_TITLE_CLICK",id:e}}(n))},errorOccured:function(n){return e(N(n))},snackbarClose:function(){return e({type:"SNACKBAR_CLOSE"})}}}))(Z),ne=function(e){Object(d.a)(t,e);var n=Object(p.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement("div",{className:"upload-screen-holder"},r.a.createElement("div",{id:"upload-panel"},r.a.createElement(q,null)),r.a.createElement("div",{id:"list-panel"},r.a.createElement(ee,null))))}}]),t}(r.a.Component),te=function(e){Object(d.a)(t,e);var n=Object(p.a)(t);function t(e){var a;return Object(s.a)(this,t),(a=n.call(this,e)).onBack=a.onBack.bind(Object(k.a)(a)),a}return Object(m.a)(t,[{key:"render",value:function(){var e,n=this.props.record,t=this.onBack,a="".concat(A,"/static/loading.gif");return e=n?[n.horizontal,n.vertical,n.horizontal_small,n.gallery]:[a,a,a,a],r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement("div",{id:"back-div"},r.a.createElement(j.a,{variant:"contained",color:"primary",onClick:t},"Back")),r.a.createElement("div",{id:"display-screen"},r.a.createElement(g.a,{variant:"h5"},"Horizontal"),r.a.createElement("div",{className:"image-row"},r.a.createElement("img",{src:e[0],className:"image"})),r.a.createElement(g.a,{variant:"h5"},"Vertical"),r.a.createElement("div",{className:"image-row"},r.a.createElement("img",{src:e[1],className:"image"})),r.a.createElement(g.a,{variant:"h5"},"Horizontal Small"),r.a.createElement("div",{className:"image-row"},r.a.createElement("img",{src:e[2],className:"image"})),r.a.createElement(g.a,{variant:"h5"},"Gallery"),r.a.createElement("div",{className:"image-row"},r.a.createElement("img",{src:e[3],className:"image"}))))}},{key:"onBack",value:function(){this.props.back()}},{key:"componentDidMount",value:function(){var e=this.props,n=e.id;(0,e.requestLinks)(n)}}]),t}(r.a.Component),ae=Object(i.b)((function(e){var n=e.displayScreen;return{record:n.record,id:n.id}}),(function(e){return{back:function(){return e({type:"BACK"})},requestLinks:function(n){return e(function(e){return function(){var n=Object(y.a)(C.a.mark((function n(t){var a,r;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t({type:"REQUEST_LINKS_STARTED"}),n.prev=1,n.next=4,B(e);case 4:a=n.sent,r=a.data,console.log(r),r.error?t({type:"RECEIVED_LINKS_ERROR"}):t({type:"RECEIVED_LINKS",record:r}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),t({type:"RECEIVED_LINKS_ERROR"});case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e){return n.apply(this,arguments)}}()}(n))}}}))(te);var re=Object(i.b)((function(e){return{screen:e.screen}}))((function(e){return"upload"===e.screen?r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,null))})),ce=t(7),oe={error:null,uploading:!1,file:null},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"FILE_CHANGED":return Object(ce.a)(Object(ce.a)({},e),{},{file:n.file});case"ERROR_OCCURED":return Object(ce.a)(Object(ce.a)({},e),{},{error:n.error});case"SNACKBAR_CLOSE":return Object(ce.a)(Object(ce.a)({},e),{},{error:null});case"START_UPLOAD":return Object(ce.a)(Object(ce.a)({},e),{},{uploading:!0});case"UPLOAD_SUCCESS":return Object(ce.a)(Object(ce.a)({},e),{},{uploading:!1});case"UPLOAD_FAILURE":return Object(ce.a)(Object(ce.a)({},e),{},{error:n.error||"File wasn't uploaded",uploading:!1})}return e},le={images:[],loading:!0},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,n=arguments.length>1?arguments[1]:void 0;return"IMAGES_ADDED"===n.type?Object(ce.a)(Object(ce.a)({},e),{},{images:e.images.concat(n.images),loading:!1}):e},se=Object(l.c)({uploadPanel:ie,listPanel:ue}),me={id:null,record:null},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"IMAGE_TITLE_CLICK":return Object(ce.a)(Object(ce.a)({},e),{},{id:n.id,record:null});case"RECEIVED_LINKS":return Object(ce.a)(Object(ce.a)({},e),{},{record:n.record})}return e},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"upload",n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"BACK":return"upload";case"IMAGE_TITLE_CLICK":return"display"}return e},fe=Object(l.c)({uploadScreen:se,displayScreen:de,screen:pe});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,ve=Object(l.e)(fe,Ee(Object(l.a)(u.a)));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{store:ve},r.a.createElement(re,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},72:function(e,n,t){e.exports=t(103)},82:function(e,n,t){},83:function(e,n,t){}},[[72,1,2]]]);
//# sourceMappingURL=main.7562b8a5.chunk.js.map